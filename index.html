<!doctype html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

        <title>Socket.IO chat</title>

        <script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
        <script src="/bower_components/webcomponentsjs/webcomponents.js"></script>

        <link rel="import" href="/bower_components/polymer/polymer.html">
        <link rel="import" href="/elements/chat-message-editor.html">
        <link rel="import" href="/elements/chat-message-view.html">

        <script>
            function onLoad() {
                var socket = io();
                var editor = document.getElementById("editor");
                var view = document.getElementById("view");

                function sendMessage(ev) {
                    socket.emit('chat message', ev.detail.message);
                }

                editor.addEventListener('message', sendMessage);

                socket.on('chat message', function(msg) {
                    view.addMessage(msg);
                });
            }
        </script>
    </head>
    <body onLoad="onLoad()" fullbleed unresolved vertical layout>
        <chat-message-view id="view" flex></chat-message-view>
        <chat-message-editor id="editor"></chat-message-editor>
    </body>
</html>
